---
title: "Agent Operations"
description: "Run an agent, track progress and download outputs."
---

## POST /run-agent

Execute an agent workflow on an uploaded video file.

```bash
curl -X POST "https://api.usemosaic.ai/api/run-agent" \
  -H "Authorization: Bearer mk_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_id": "22aa8e28-6178-4587-8cce-9d8cdb62a32c",
    "file_id": "550e8400-e29b-41d4-a716-446655440000",
    "auto": true
  }'
```

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| agent_id | string (UUID) | ✅ | ID of the agent to run |
| file_id | string (UUID) | ✅ | ID of the uploaded file |
| parameters | object | | Key-value overrides for agent fields |
| auto | boolean | | Let Mosaic choose optimal parameters |

### Response

```json
{
  "agent_run_id": "run_uuid",
  "project_id": "project_uuid",
  "agent_group_id": "group_uuid"
}
```

---

## GET /get-agent-run/{agent_run_id}

Get full run details including the workflow graph.

### Response
```json
{
  "id": "run_uuid",
  "status": "running | completed | failed",
  "graph": {
    "nodes": [...],
    "edges": [...]
  }
}
```

---

## GET /get-agent-run-simple/{agent_run_id}

Returns the same high-level metadata without the heavy graph payload. Poll this endpoint every ~5 seconds.

---

## GET /get-agent-run-outputs/{agent_run_id}

Retrieve signed download URLs for all outputs of the run.

```json
{
  "outputs": [
    {
      "node_id": "node_uuid",
      "file_id": "file_uuid",
      "download_url": "https://...",
      "thumbnail_url": "https://...",
      "duration_ms": 30000,
      "file_size": 1048576,
      "status": "success"
    }
  ]
}
```

---

## GET /download-rendered-video/{agent_run_node_id}

Direct download for a specific node when you already know its ID.

> **Tip**: Prefer `/get-agent-run-outputs` which shields you from internal node identifiers. 

---

## POST /retry-agent-run-node/{agent_run_node_id}

Retry a specific **failed** node within an agent run instead of re-running the entire workflow.

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| agent_run_node_id (path) | UUID | ✅ | ID of the node to retry. Must currently have `status=failed`. |

Authentication: same as other operational endpoints – Bearer API key (`mk_…`) **or** Supabase session. Anonymous requests are rejected with `401`.

### Request
```http
POST /retry-agent-run-node/{agent_run_node_id}
Authorization: Bearer mk_live_xxx…
Content-Type: application/json

{}
```

### Successful response
```json
{
  "success": true,
  "agent_run_node_id": "ab12cdef-3456-7890-abcd-ef1234567890",
  "status": "initiated",
  "message": "Agent run node retry initiated"
}
```
*HTTP 200* — the node (and all downstream nodes) are reset to `not_started`; the parent run switches back to `running`.

### Error codes
| HTTP | error | Reason |
|------|-------|--------|
| 400 | invalid_state | Node isn't in `failed` state |
| 401 | invalid_api_key | Missing / invalid credentials |
| 403 | forbidden | Node belongs to another user / too many concurrent retries |
| 404 | not_found | Unknown node ID |
| 500 | internal_error | Unexpected server exception |

### Curl example
```bash
curl -X POST "https://api.usemosaic.ai/api/retry-agent-run-node/ab12cdef-3456-7890" \
     -H "Authorization: Bearer $MOSAIC_API_KEY" \
     -H "Content-Type: application/json" \
     -d '{}'
```

> **Limits**: Up to **three concurrent retries per agent run**. Additional attempts return `403 too_many_retries`. Calling the endpoint again while the node is already being retried is a no-op. 